# 钱包选择器测试指南

## 测试前准备

1. **确保服务器运行**：
   ```bash
   npm start
   ```

2. **启动前端开发服务器**：
   ```bash
   npm run dev:frontend
   ```

3. **访问网站**：`http://localhost:5173`

## 测试场景

### 场景 1：单个钱包（MetaMask）

**步骤**：
1. 确保只安装了 MetaMask 扩展
2. 刷新页面
3. 点击 "Unlock All Access" 按钮
4. **预期**：应该显示钱包选择器，只显示 MetaMask
5. 点击 MetaMask
6. **预期**：MetaMask 弹窗请求连接
7. 确认连接
8. **预期**：自动继续支付流程

### 场景 2：多个钱包

**步骤**：
1. 安装 MetaMask 和 OKX Wallet（或 Coinbase Wallet）
2. 刷新页面
3. 点击 "Unlock All Access" 按钮
4. **预期**：显示钱包选择器，列出所有已安装的钱包
5. 选择 OKX Wallet
6. **预期**：OKX Wallet 弹窗请求连接
7. 确认连接
8. **预期**：自动继续支付流程

### 场景 3：无钱包

**步骤**：
1. 禁用所有钱包扩展
2. 刷新页面
3. 点击 "Unlock All Access" 按钮
4. **预期**：显示钱包选择器，显示 "No wallets detected"
5. **预期**：显示下载链接（MetaMask, Binance, OKX）
6. 点击下载链接
7. **预期**：应该打开相应的钱包下载页面

### 场景 4：已连接钱包

**步骤**：
1. 已经连接钱包（之前测试时连接的）
2. 刷新页面
3. 点击 "Unlock All Access" 按钮
4. **预期**：不显示钱包选择器，直接继续支付流程（因为已连接）

### 场景 5：EIP-6963 钱包检测

**步骤**：
1. 安装支持 EIP-6963 的钱包（如最新版 MetaMask）
2. 刷新页面
3. 打开浏览器控制台（F12）
4. 点击 "Unlock All Access" 按钮
5. **预期**：钱包选择器应该通过 EIP-6963 检测到钱包
6. 检查控制台，应该没有错误

### 场景 6：网络切换

**步骤**：
1. 连接钱包（MetaMask）
2. 确保钱包不在 Base 网络（如在 Ethereum Mainnet）
3. 点击 "Unlock All Access" 并选择钱包连接
4. **预期**：应该提示切换到 Base 网络
5. 确认切换
6. **预期**：网络切换后继续支付流程

### 场景 7：支付流程完整性

**步骤**：
1. 选择钱包连接
2. 网络切换到 Base（如果需要）
3. 确认 USDC 支付
4. 等待交易确认
5. **预期**：内容解锁，可以下载文件

## 调试技巧

### 查看钱包检测

打开浏览器控制台（F12），检查：
- 是否有钱包检测相关的错误
- EIP-6963 事件是否触发

### 检查网络切换

在控制台中检查：
- 是否有网络切换请求
- 是否有网络添加请求
- 错误消息是否清晰

### 常见问题

1. **钱包选择器不显示**：
   - 检查 `showWalletSelector` 状态
   - 检查是否有 JavaScript 错误

2. **钱包连接失败**：
   - 检查钱包扩展是否启用
   - 检查控制台错误信息
   - 确认钱包支持 EIP-1193 标准

3. **网络切换失败**：
   - 检查钱包是否支持网络切换
   - 检查 Base 网络配置是否正确
   - 查看错误消息

## 验证清单

- [ ] 钱包选择器正确显示
- [ ] 能检测到已安装的钱包
- [ ] 点击钱包后能正确连接
- [ ] 网络切换功能正常
- [ ] 支付流程完整
- [ ] 无钱包时显示下载链接
- [ ] 已连接时不重复显示选择器
- [ ] 错误处理正确
- [ ] UI 美观且响应式

---

**测试完成后，确认所有功能正常！**




